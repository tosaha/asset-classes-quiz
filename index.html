<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Asset Class Selection Guide | Find Your Ideal Trading Market</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #2563eb;
            --primary-dark: #1e40af;
            --secondary: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --text: #1f2937;
            --text-light: #6b7280;
            --bg: #f9fafb;
            --white: #ffffff;
            --border: #e5e7eb;
            --shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            color: var(--text);
        }

        .main-wrapper {
            display: flex;
            gap: 20px;
            max-width: 1400px;
            width: 100%;
            align-items: flex-start;
        }

        .container {
            flex: 1;
            max-width: 800px;
            width: 100%;
            background: var(--white);
            border-radius: 16px;
            box-shadow: var(--shadow-lg);
            overflow: hidden;
            animation: fadeIn 0.5s ease;
        }

        .score-panel {
            width: 320px;
            background: var(--white);
            border-radius: 16px;
            box-shadow: var(--shadow-lg);
            padding: 20px;
            position: sticky;
            top: 20px;
            animation: fadeIn 0.5s ease;
            display: none;
        }

        .score-panel.active {
            display: block;
        }

        .score-panel h3 {
            font-size: 18px;
            margin-bottom: 20px;
            color: var(--text);
            font-weight: 600;
        }

        .asset-score-item {
            margin-bottom: 16px;
            padding: 12px;
            background: var(--bg);
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .asset-score-item.leading {
            background: linear-gradient(135deg, #eef2ff 0%, #ffffff 100%);
            border: 2px solid var(--primary);
        }

        .asset-score-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .asset-score-name {
            font-weight: 500;
            font-size: 14px;
            color: var(--text);
        }

        .asset-score-value {
            font-weight: 600;
            font-size: 16px;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .score-change {
            font-size: 12px;
            padding: 2px 6px;
            border-radius: 4px;
            animation: scoreChange 0.5s ease;
        }

        .score-change.positive {
            color: var(--secondary);
            background: rgba(16, 185, 129, 0.1);
        }

        .score-change.negative {
            color: var(--danger);
            background: rgba(239, 68, 68, 0.1);
        }

        .score-change.neutral {
            color: var(--text-light);
            background: rgba(107, 114, 128, 0.1);
        }

        @keyframes scoreChange {
            0% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        .asset-score-bar {
            height: 8px;
            background: var(--border);
            border-radius: 4px;
            overflow: hidden;
        }

        .asset-score-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            border-radius: 4px;
            transition: width 0.5s ease;
            width: 0%;
        }

        .question-impact {
            margin-top: 20px;
            padding: 15px;
            background: linear-gradient(135deg, #f0f9ff 0%, #ffffff 100%);
            border-radius: 8px;
            border-left: 3px solid var(--primary);
        }

        .question-impact h4 {
            font-size: 13px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--text-light);
            margin-bottom: 8px;
        }

        .question-impact p {
            font-size: 14px;
            color: var(--text);
            line-height: 1.5;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .header p {
            opacity: 0.9;
            font-size: 16px;
        }

        .progress-bar {
            height: 4px;
            background: rgba(255, 255, 255, 0.2);
            margin-top: 20px;
            border-radius: 2px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--secondary);
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 2px;
        }

        .content {
            padding: 40px 30px;
        }

        .question-container {
            display: none;
            animation: slideIn 0.3s ease;
        }

        .question-container.active {
            display: block;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .question {
            font-size: 20px;
            font-weight: 500;
            margin-bottom: 10px;
            color: var(--text);
        }

        .question-description {
            font-size: 14px;
            color: var(--text-light);
            margin-bottom: 25px;
            line-height: 1.5;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .option {
            background: var(--bg);
            border: 2px solid var(--border);
            border-radius: 8px;
            padding: 18px;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
        }

        .option:hover {
            border-color: var(--primary);
            background: var(--white);
            box-shadow: var(--shadow);
            transform: translateX(4px);
        }

        .option.selected {
            background: var(--white);
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .option-title {
            font-weight: 500;
            margin-bottom: 4px;
            font-size: 16px;
        }

        .option-description {
            font-size: 13px;
            color: var(--text-light);
            line-height: 1.4;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid var(--border);
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            font-size: 15px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn-secondary {
            background: var(--bg);
            color: var(--text);
        }

        .btn-secondary:hover {
            background: var(--border);
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-1px);
            box-shadow: var(--shadow);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .results-container {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .results-container.active {
            display: block;
        }

        .result-card {
            background: linear-gradient(135deg, #f6f8fb 0%, #ffffff 100%);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 20px;
            position: relative;
            overflow: hidden;
        }

        .result-card.primary {
            border: 2px solid var(--primary);
            background: linear-gradient(135deg, #eef2ff 0%, #ffffff 100%);
        }

        .match-badge {
            position: absolute;
            top: 20px;
            right: 20px;
            background: var(--secondary);
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 600;
        }

        .result-card.primary .match-badge {
            background: var(--primary);
        }

        .asset-name {
            font-size: 22px;
            font-weight: 600;
            margin-bottom: 12px;
            color: var(--text);
        }

        .asset-characteristics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .characteristic {
            display: flex;
            flex-direction: column;
        }

        .characteristic-label {
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--text-light);
            margin-bottom: 4px;
        }

        .characteristic-value {
            font-size: 14px;
            font-weight: 500;
            color: var(--text);
        }

        .rating {
            display: flex;
            gap: 2px;
        }

        .rating-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--border);
        }

        .rating-dot.filled {
            background: var(--primary);
        }

        .recommendation-reason {
            background: var(--bg);
            border-left: 3px solid var(--primary);
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .recommendation-reason h4 {
            font-size: 14px;
            margin-bottom: 8px;
            color: var(--text);
        }

        .recommendation-reason p {
            font-size: 13px;
            color: var(--text-light);
            line-height: 1.5;
        }

        .action-buttons {
            display: flex;
            gap: 12px;
            margin-top: 30px;
        }

        .tooltip {
            position: relative;
            display: inline-block;
            cursor: help;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 200px;
            background-color: var(--text);
            color: white;
            text-align: center;
            border-radius: 6px;
            padding: 8px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 12px;
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }

        .start-screen {
            text-align: center;
            padding: 40px 20px;
        }

        .start-screen h2 {
            font-size: 28px;
            margin-bottom: 20px;
            color: var(--text);
        }

        .start-screen p {
            font-size: 16px;
            color: var(--text-light);
            line-height: 1.6;
            margin-bottom: 30px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .feature-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .feature {
            padding: 20px;
            background: var(--bg);
            border-radius: 8px;
            text-align: center;
        }

        .feature-icon {
            font-size: 30px;
            margin-bottom: 10px;
        }

        .feature-text {
            font-size: 14px;
            color: var(--text);
        }

        @media (max-width: 1200px) {
            .main-wrapper {
                flex-direction: column;
            }

            .score-panel {
                width: 100%;
                position: static;
                margin-bottom: 20px;
            }
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 24px;
            }

            .content {
                padding: 30px 20px;
            }

            .question {
                font-size: 18px;
            }

            .asset-characteristics {
                grid-template-columns: 1fr;
            }

            .score-panel {
                padding: 15px;
            }

            .asset-score-item {
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="main-wrapper">
        <div class="container">
            <div class="header">
                <h1>Asset Class Selection Guide</h1>
                <p>Find your ideal trading market based on your preferences and temperament</p>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressBar"></div>
                </div>
            </div>

        <div class="content">
            <!-- Start Screen -->
            <div id="startScreen" class="start-screen">
                <h2>Welcome to Your Trading Journey</h2>
                <p>This comprehensive assessment will help you identify the asset classes that best match your trading style, risk tolerance, and personal circumstances.</p>
                
                <div class="feature-list">
                    <div class="feature">
                        <div class="feature-icon">📊</div>
                        <div class="feature-text">Personalized Analysis</div>
                    </div>
                    <div class="feature">
                        <div class="feature-icon">⚡</div>
                        <div class="feature-text">10 Quick Questions</div>
                    </div>
                    <div class="feature">
                        <div class="feature-icon">🎯</div>
                        <div class="feature-text">Data-Driven Results</div>
                    </div>
                    <div class="feature">
                        <div class="feature-icon">📚</div>
                        <div class="feature-text">Educational Insights</div>
                    </div>
                </div>

                <button class="btn btn-primary" onclick="startQuiz()">Start Assessment</button>
            </div>

            <!-- Quiz Container -->
            <div id="quizContainer" style="display: none;">
                <!-- Questions will be dynamically inserted here -->
            </div>

            <!-- Results Container -->
            <div id="resultsContainer" class="results-container">
                <!-- Results will be dynamically inserted here -->
            </div>
        </div>
    </div>

    <!-- Score Panel -->
    <div id="scorePanel" class="score-panel">
        <h3>Live Match Scores</h3>
        <div id="assetScores">
            <!-- Asset scores will be dynamically inserted here -->
        </div>
        <div class="question-impact" id="questionImpact" style="display: none;">
            <h4>Current Question Impact</h4>
            <p id="impactDescription"></p>
        </div>
    </div>
</div>

    <script>
        // Asset class data with comprehensive characteristics
        const assetClasses = {
            stocks: {
                name: "Stocks & ETFs",
                volatility: "Medium",
                liquidity: "High",
                capital: "$500-25,000",
                hours: "Market Hours (9:30-4:00 ET)",
                learning: "Moderate",
                characteristics: {
                    timeframe: "Minutes to Years",
                    leverage: "1x-4x",
                    regulation: "High",
                    tools: "Extensive"
                }
            },
            crypto: {
                name: "Cryptocurrency",
                volatility: "Very High",
                liquidity: "High (Major Pairs)",
                capital: "$100+",
                hours: "24/7",
                learning: "Moderate-High",
                characteristics: {
                    timeframe: "Seconds to Years",
                    leverage: "Up to 100x",
                    regulation: "Low-Medium",
                    tools: "Growing"
                }
            },
            forex: {
                name: "Foreign Exchange (Forex)",
                volatility: "Low-Medium",
                liquidity: "Very High",
                capital: "$100-500",
                hours: "24/5",
                learning: "Moderate",
                characteristics: {
                    timeframe: "Seconds to Months",
                    leverage: "Up to 50x",
                    regulation: "High",
                    tools: "Extensive"
                }
            },
            futures: {
                name: "Futures & Commodities",
                volatility: "High",
                liquidity: "High",
                capital: "$2,500-10,000",
                hours: "Nearly 24h",
                learning: "High",
                characteristics: {
                    timeframe: "Minutes to Months",
                    leverage: "5x-20x",
                    regulation: "High",
                    tools: "Professional"
                }
            },
            options: {
                name: "Options",
                volatility: "Variable",
                liquidity: "Medium-High",
                capital: "$1,000-5,000",
                hours: "Market Hours",
                learning: "Very High",
                characteristics: {
                    timeframe: "Days to Years",
                    leverage: "Variable",
                    regulation: "High",
                    tools: "Complex"
                }
            }
        };

        // Quiz questions with weighted scoring for each asset class
        const questions = [
            {
                id: 1,
                question: "What is your risk tolerance for price swings?",
                description: "How comfortable are you with seeing your positions move significantly in value?",
                options: [
                    {
                        text: "Conservative",
                        description: "I prefer stable, predictable movements (±2-5% swings)",
                        scores: { stocks: 3, crypto: 0, forex: 5, futures: 1, options: 2 }
                    },
                    {
                        text: "Moderate",
                        description: "I can handle normal volatility (±5-15% swings)",
                        scores: { stocks: 5, crypto: 2, forex: 4, futures: 3, options: 4 }
                    },
                    {
                        text: "Aggressive",
                        description: "I thrive on high volatility (±15-50%+ swings)",
                        scores: { stocks: 2, crypto: 5, forex: 1, futures: 5, options: 5 }
                    }
                ]
            },
            {
                id: 2,
                question: "How much capital are you planning to start with?",
                description: "Your initial trading capital will influence which markets are accessible to you.",
                options: [
                    {
                        text: "Under $1,000",
                        description: "Starting small to learn the ropes",
                        scores: { stocks: 2, crypto: 5, forex: 5, futures: 0, options: 1 }
                    },
                    {
                        text: "$1,000 - $10,000",
                        description: "Moderate starting capital",
                        scores: { stocks: 4, crypto: 5, forex: 5, futures: 2, options: 4 }
                    },
                    {
                        text: "$10,000 - $25,000",
                        description: "Substantial capital for more opportunities",
                        scores: { stocks: 5, crypto: 5, forex: 5, futures: 4, options: 5 }
                    },
                    {
                        text: "Over $25,000",
                        description: "Professional level capital (PDT rule exempt)",
                        scores: { stocks: 5, crypto: 5, forex: 5, futures: 5, options: 5 }
                    }
                ]
            },
            {
                id: 3,
                question: "When can you actively trade?",
                description: "Different markets operate at different times. When are you most available?",
                options: [
                    {
                        text: "US Market Hours (9:30 AM - 4:00 PM ET)",
                        description: "Traditional trading hours",
                        scores: { stocks: 5, crypto: 2, forex: 2, futures: 3, options: 5 }
                    },
                    {
                        text: "Asian/European Hours",
                        description: "Overnight US time",
                        scores: { stocks: 1, crypto: 5, forex: 5, futures: 4, options: 1 }
                    },
                    {
                        text: "Flexible/24-7",
                        description: "I can trade anytime",
                        scores: { stocks: 3, crypto: 5, forex: 5, futures: 5, options: 3 }
                    },
                    {
                        text: "Weekends Only",
                        description: "Limited to weekend trading",
                        scores: { stocks: 0, crypto: 5, forex: 1, futures: 1, options: 0 }
                    }
                ]
            },
            {
                id: 4,
                question: "What's your preferred trading timeframe?",
                description: "How long do you typically want to hold positions?",
                options: [
                    {
                        text: "Scalping (Seconds to Minutes)",
                        description: "Ultra-short term, many trades per day",
                        scores: { stocks: 2, crypto: 5, forex: 5, futures: 5, options: 1 }
                    },
                    {
                        text: "Day Trading (Minutes to Hours)",
                        description: "Close all positions before market close",
                        scores: { stocks: 4, crypto: 5, forex: 5, futures: 5, options: 3 }
                    },
                    {
                        text: "Swing Trading (Days to Weeks)",
                        description: "Capture medium-term price movements",
                        scores: { stocks: 5, crypto: 4, forex: 3, futures: 3, options: 5 }
                    },
                    {
                        text: "Position Trading (Weeks to Months)",
                        description: "Long-term trend following",
                        scores: { stocks: 5, crypto: 3, forex: 2, futures: 2, options: 4 }
                    }
                ]
            },
            {
                id: 5,
                question: "What type of analysis appeals to you most?",
                description: "How do you prefer to make trading decisions?",
                options: [
                    {
                        text: "Technical Analysis",
                        description: "Charts, patterns, and indicators",
                        scores: { stocks: 4, crypto: 5, forex: 5, futures: 5, options: 3 }
                    },
                    {
                        text: "Fundamental Analysis",
                        description: "Company/economic data and news",
                        scores: { stocks: 5, crypto: 2, forex: 4, futures: 3, options: 4 }
                    },
                    {
                        text: "Sentiment & Social",
                        description: "Market sentiment and social trends",
                        scores: { stocks: 3, crypto: 5, forex: 2, futures: 2, options: 3 }
                    },
                    {
                        text: "Quantitative/Algorithmic",
                        description: "Data-driven and systematic",
                        scores: { stocks: 4, crypto: 4, forex: 5, futures: 5, options: 5 }
                    }
                ]
            },
            {
                id: 6,
                question: "How do you handle losses?",
                description: "Understanding your emotional response to drawdowns is crucial.",
                options: [
                    {
                        text: "Very Sensitive",
                        description: "Small losses affect me significantly",
                        scores: { stocks: 4, crypto: 1, forex: 3, futures: 1, options: 2 }
                    },
                    {
                        text: "Moderate Tolerance",
                        description: "I can handle normal trading losses",
                        scores: { stocks: 5, crypto: 3, forex: 5, futures: 3, options: 4 }
                    },
                    {
                        text: "High Tolerance",
                        description: "I view losses as learning opportunities",
                        scores: { stocks: 3, crypto: 5, forex: 4, futures: 5, options: 5 }
                    }
                ]
            },
            {
                id: 7,
                question: "What's your experience with leverage?",
                description: "Leverage can amplify both gains and losses.",
                options: [
                    {
                        text: "No Experience/Avoid",
                        description: "Prefer to trade without leverage",
                        scores: { stocks: 5, crypto: 2, forex: 1, futures: 0, options: 2 }
                    },
                    {
                        text: "Some Experience",
                        description: "Comfortable with moderate leverage (2-5x)",
                        scores: { stocks: 4, crypto: 4, forex: 4, futures: 3, options: 4 }
                    },
                    {
                        text: "Very Experienced",
                        description: "Skilled at managing high leverage positions",
                        scores: { stocks: 2, crypto: 5, forex: 5, futures: 5, options: 5 }
                    }
                ]
            },
            {
                id: 8,
                question: "What interests you most about markets?",
                description: "What drives your passion for trading?",
                options: [
                    {
                        text: "Business & Innovation",
                        description: "Company growth and sector trends",
                        scores: { stocks: 5, crypto: 3, forex: 1, futures: 2, options: 4 }
                    },
                    {
                        text: "Technology & Disruption",
                        description: "New technologies and paradigm shifts",
                        scores: { stocks: 3, crypto: 5, forex: 1, futures: 2, options: 3 }
                    },
                    {
                        text: "Global Economics",
                        description: "Macroeconomics and geopolitics",
                        scores: { stocks: 3, crypto: 2, forex: 5, futures: 4, options: 3 }
                    },
                    {
                        text: "Mathematical Patterns",
                        description: "Price action and statistical edges",
                        scores: { stocks: 3, crypto: 4, forex: 5, futures: 5, options: 5 }
                    }
                ]
            },
            {
                id: 9,
                question: "How important is regulation and investor protection?",
                description: "Different markets have varying levels of regulatory oversight.",
                options: [
                    {
                        text: "Very Important",
                        description: "I want maximum regulatory protection",
                        scores: { stocks: 5, crypto: 1, forex: 4, futures: 5, options: 5 }
                    },
                    {
                        text: "Somewhat Important",
                        description: "Balance between freedom and protection",
                        scores: { stocks: 4, crypto: 3, forex: 4, futures: 4, options: 4 }
                    },
                    {
                        text: "Not Important",
                        description: "I prefer less regulated markets",
                        scores: { stocks: 2, crypto: 5, forex: 3, futures: 2, options: 2 }
                    }
                ]
            },
            {
                id: 10,
                question: "What's your learning style preference?",
                description: "How do you prefer to acquire trading knowledge?",
                options: [
                    {
                        text: "Structured Education",
                        description: "Courses, books, and formal training",
                        scores: { stocks: 5, crypto: 3, forex: 4, futures: 4, options: 5 }
                    },
                    {
                        text: "Community Learning",
                        description: "Forums, social media, and peer groups",
                        scores: { stocks: 3, crypto: 5, forex: 3, futures: 2, options: 3 }
                    },
                    {
                        text: "Trial and Error",
                        description: "Learn by doing with small positions",
                        scores: { stocks: 3, crypto: 5, forex: 5, futures: 3, options: 2 }
                    },
                    {
                        text: "Mentorship",
                        description: "One-on-one guidance from experts",
                        scores: { stocks: 4, crypto: 3, forex: 4, futures: 5, options: 5 }
                    }
                ]
            }
        ];

        let currentQuestion = 0;
        let answers = [];
        let scores = {
            stocks: 0,
            crypto: 0,
            forex: 0,
            futures: 0,
            options: 0
        };
        let previousScores = {
            stocks: 0,
            crypto: 0,
            forex: 0,
            futures: 0,
            options: 0
        };
        let tempScores = {
            stocks: 0,
            crypto: 0,
            forex: 0,
            futures: 0,
            options: 0
        };

        function startQuiz() {
            document.getElementById('startScreen').style.display = 'none';
            document.getElementById('quizContainer').style.display = 'block';
            document.getElementById('scorePanel').classList.add('active');
            initializeScorePanel();
            renderQuestion();
        }

        function initializeScorePanel() {
            const scoresHtml = Object.keys(assetClasses).map(key => `
                <div class="asset-score-item" id="score-${key}">
                    <div class="asset-score-header">
                        <div class="asset-score-name">${assetClasses[key].name}</div>
                        <div class="asset-score-value">
                            <span id="score-value-${key}">0%</span>
                            <span class="score-change neutral" id="score-change-${key}" style="display: none;">0</span>
                        </div>
                    </div>
                    <div class="asset-score-bar">
                        <div class="asset-score-fill" id="score-bar-${key}" style="width: 0%"></div>
                    </div>
                </div>
            `).join('');
            
            document.getElementById('assetScores').innerHTML = scoresHtml;
        }

        function updateScorePanel(showChange = false) {
            const maxPossibleScore = questions.length * 5;
            
            Object.keys(scores).forEach(key => {
                const percentage = Math.round((scores[key] / maxPossibleScore) * 100);
                const changeValue = scores[key] - previousScores[key];
                
                // Update score value
                document.getElementById(`score-value-${key}`).textContent = `${percentage}%`;
                
                // Update progress bar
                document.getElementById(`score-bar-${key}`).style.width = `${percentage}%`;
                
                // Show score change if applicable
                if (showChange && changeValue !== 0) {
                    const changeElement = document.getElementById(`score-change-${key}`);
                    changeElement.style.display = 'inline';
                    changeElement.textContent = changeValue > 0 ? `+${changeValue}` : `${changeValue}`;
                    changeElement.className = `score-change ${changeValue > 0 ? 'positive' : changeValue < 0 ? 'negative' : 'neutral'}`;
                    
                    // Hide after animation
                    setTimeout(() => {
                        changeElement.style.display = 'none';
                    }, 2000);
                }
            });
            
            // Highlight leading asset
            const sortedAssets = Object.keys(scores).sort((a, b) => scores[b] - scores[a]);
            document.querySelectorAll('.asset-score-item').forEach(item => {
                item.classList.remove('leading');
            });
            if (scores[sortedAssets[0]] > 0) {
                document.getElementById(`score-${sortedAssets[0]}`).classList.add('leading');
            }
        }

        function previewOptionScores(optionIndex) {
            const question = questions[currentQuestion];
            const option = question.options[optionIndex];
            
            // Copy current scores to temp
            Object.keys(scores).forEach(key => {
                tempScores[key] = scores[key];
            });
            
            // Add option scores to temp
            Object.keys(option.scores).forEach(asset => {
                tempScores[asset] += option.scores[asset];
            });
            
            // Update display with temp scores
            const maxPossibleScore = questions.length * 5;
            Object.keys(tempScores).forEach(key => {
                const currentPercentage = Math.round((scores[key] / maxPossibleScore) * 100);
                const tempPercentage = Math.round((tempScores[key] / maxPossibleScore) * 100);
                const change = option.scores[key] || 0;
                
                if (change !== 0) {
                    const changeElement = document.getElementById(`score-change-${key}`);
                    changeElement.style.display = 'inline';
                    changeElement.textContent = change > 0 ? `+${change}` : `${change}`;
                    changeElement.className = `score-change ${change > 0 ? 'positive' : change < 0 ? 'negative' : 'neutral'}`;
                }
            });
            
            // Show impact description
            const impactDiv = document.getElementById('questionImpact');
            const impactDesc = document.getElementById('impactDescription');
            impactDiv.style.display = 'block';
            
            const topImpacts = Object.keys(option.scores)
                .filter(key => option.scores[key] > 3)
                .map(key => assetClasses[key].name);
            
            if (topImpacts.length > 0) {
                impactDesc.textContent = `This choice strongly favors: ${topImpacts.join(', ')}`;
            } else {
                impactDesc.textContent = 'This choice provides balanced scoring across asset classes.';
            }
        }

        function clearPreview() {
            Object.keys(scores).forEach(key => {
                const changeElement = document.getElementById(`score-change-${key}`);
                changeElement.style.display = 'none';
            });
            document.getElementById('questionImpact').style.display = 'none';
        }

        function renderQuestion() {
            const container = document.getElementById('quizContainer');
            const question = questions[currentQuestion];
            
            // Update progress bar
            const progress = ((currentQuestion + 1) / questions.length) * 100;
            document.getElementById('progressBar').style.width = `${progress}%`;
            
            container.innerHTML = `
                <div class="question-container active">
                    <h3 class="question">Question ${currentQuestion + 1} of ${questions.length}</h3>
                    <h2 class="question">${question.question}</h2>
                    <p class="question-description">${question.description}</p>
                    <div class="options">
                        ${question.options.map((option, index) => `
                            <div class="option" 
                                onclick="selectOption(${index})"
                                onmouseover="previewOptionScores(${index})"
                                onmouseout="clearPreview()">
                                <div class="option-title">${option.text}</div>
                                <div class="option-description">${option.description}</div>
                            </div>
                        `).join('')}
                    </div>
                    <div class="navigation">
                        <button class="btn btn-secondary" onclick="previousQuestion()" ${currentQuestion === 0 ? 'disabled' : ''}>
                            Previous
                        </button>
                        <button class="btn btn-primary" onclick="nextQuestion()" id="nextBtn" disabled>
                            ${currentQuestion === questions.length - 1 ? 'See Results' : 'Next'}
                        </button>
                    </div>
                </div>
            `;
            
            // Restore selected option if going back
            if (answers[currentQuestion] !== undefined) {
                const options = container.querySelectorAll('.option');
                options[answers[currentQuestion]].classList.add('selected');
                document.getElementById('nextBtn').disabled = false;
            }
        }

        function selectOption(index) {
            const options = document.querySelectorAll('.option');
            options.forEach(opt => opt.classList.remove('selected'));
            options[index].classList.add('selected');
            
            // If changing answer, revert previous scores
            if (answers[currentQuestion] !== undefined && answers[currentQuestion] !== index) {
                const oldOption = questions[currentQuestion].options[answers[currentQuestion]];
                Object.keys(oldOption.scores).forEach(asset => {
                    scores[asset] -= oldOption.scores[asset];
                });
            }
            
            // Apply new scores
            const newOption = questions[currentQuestion].options[index];
            Object.keys(scores).forEach(key => {
                previousScores[key] = scores[key];
            });
            Object.keys(newOption.scores).forEach(asset => {
                scores[asset] += newOption.scores[asset];
            });
            
            answers[currentQuestion] = index;
            document.getElementById('nextBtn').disabled = false;
            
            // Update score panel with animation
            updateScorePanel(true);
            clearPreview();
        }

        function nextQuestion() {
            if (answers[currentQuestion] === undefined) {
                alert('Please select an option before continuing.');
                return;
            }
            
            if (currentQuestion < questions.length - 1) {
                currentQuestion++;
                renderQuestion();
                updateScorePanel(false);
            } else {
                calculateResults();
            }
        }

        function previousQuestion() {
            if (currentQuestion > 0) {
                // Revert scores for current answer if it exists
                if (answers[currentQuestion] !== undefined) {
                    const option = questions[currentQuestion].options[answers[currentQuestion]];
                    Object.keys(option.scores).forEach(asset => {
                        scores[asset] -= option.scores[asset];
                    });
                }
                
                currentQuestion--;
                renderQuestion();
                updateScorePanel(false);
            }
        }

        function calculateResults() {
            // Scores are already calculated in real-time, just display results
            displayResults();
        }

        function displayResults() {
            document.getElementById('quizContainer').style.display = 'none';
            document.getElementById('resultsContainer').classList.add('active');
            document.getElementById('scorePanel').classList.remove('active');
            
            // Calculate percentages for display
            const maxPossibleScore = questions.length * 5;
            const percentageScores = {};
            Object.keys(scores).forEach(key => {
                percentageScores[key] = Math.round((scores[key] / maxPossibleScore) * 100);
            });
            
            // Sort assets by score
            const sortedAssets = Object.keys(percentageScores).sort((a, b) => percentageScores[b] - percentageScores[a]);
            
            // Generate recommendations
            const recommendations = sortedAssets.slice(0, 3).map((asset, index) => {
                const assetData = assetClasses[asset];
                const score = percentageScores[asset];
                const isPrimary = index === 0 && score > 60;
                
                return generateRecommendationCard(asset, assetData, score, isPrimary);
            });
            
            document.getElementById('resultsContainer').innerHTML = `
                <h2 class="question">Your Personalized Results</h2>
                <p class="question-description">Based on your responses, here are your recommended asset classes:</p>
                ${recommendations.join('')}
                <div class="action-buttons">
                    <button class="btn btn-secondary" onclick="resetQuiz()">Retake Quiz</button>
                    <button class="btn btn-primary" onclick="window.print()">Save Results</button>
                </div>
            `;
        }

        function generateRecommendationCard(assetKey, assetData, score, isPrimary) {
            const matchLevel = score >= 80 ? 'Excellent' : score >= 60 ? 'Good' : 'Fair';
            const reasons = generateReasons(assetKey);
            
            return `
                <div class="result-card ${isPrimary ? 'primary' : ''}">
                    <div class="match-badge">${score}% Match</div>
                    <h3 class="asset-name">${assetData.name}</h3>
                    
                    <div class="asset-characteristics">
                        <div class="characteristic">
                            <div class="characteristic-label">Volatility</div>
                            <div class="characteristic-value">${assetData.volatility}</div>
                        </div>
                        <div class="characteristic">
                            <div class="characteristic-label">Liquidity</div>
                            <div class="characteristic-value">${assetData.liquidity}</div>
                        </div>
                        <div class="characteristic">
                            <div class="characteristic-label">Capital Required</div>
                            <div class="characteristic-value">${assetData.capital}</div>
                        </div>
                        <div class="characteristic">
                            <div class="characteristic-label">Trading Hours</div>
                            <div class="characteristic-value">${assetData.hours}</div>
                        </div>
                        <div class="characteristic">
                            <div class="characteristic-label">Learning Curve</div>
                            <div class="characteristic-value">${assetData.learning}</div>
                        </div>
                        <div class="characteristic">
                            <div class="characteristic-label">Match Level</div>
                            <div class="characteristic-value">
                                <div class="rating">
                                    ${generateRating(score)}
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="recommendation-reason">
                        <h4>Why This Asset Class?</h4>
                        <p>${reasons}</p>
                    </div>
                </div>
            `;
        }

        function generateRating(score) {
            const filled = Math.round(score / 20);
            let rating = '';
            for (let i = 0; i < 5; i++) {
                rating += `<div class="rating-dot ${i < filled ? 'filled' : ''}"></div>`;
            }
            return rating;
        }

        function generateReasons(assetKey) {
            const reasons = {
                stocks: "Stocks offer excellent educational resources, strong regulatory protection, and suit various trading styles. They're ideal for those interested in business fundamentals and long-term wealth building.",
                crypto: "Cryptocurrency markets provide 24/7 trading opportunities, low barriers to entry, and high volatility for active traders. Perfect for tech-savvy traders who thrive on innovation and rapid market movements.",
                forex: "Forex markets offer the highest liquidity, flexible leverage options, and round-the-clock trading during weekdays. Ideal for those interested in global macroeconomics and technical analysis.",
                futures: "Futures provide professional-grade tools, diverse market exposure, and efficient capital usage through leverage. Best suited for disciplined traders who understand risk management.",
                options: "Options offer sophisticated strategies for income generation and risk hedging. They're perfect for analytical traders who enjoy complex problem-solving and strategic thinking."
            };
            
            return reasons[assetKey];
        }

        function resetQuiz() {
            currentQuestion = 0;
            answers = [];
            scores = {
                stocks: 0,
                crypto: 0,
                forex: 0,
                futures: 0,
                options: 0
            };
            previousScores = {
                stocks: 0,
                crypto: 0,
                forex: 0,
                futures: 0,
                options: 0
            };
            tempScores = {
                stocks: 0,
                crypto: 0,
                forex: 0,
                futures: 0,
                options: 0
            };
            
            document.getElementById('resultsContainer').classList.remove('active');
            document.getElementById('resultsContainer').style.display = 'none';
            document.getElementById('scorePanel').classList.remove('active');
            document.getElementById('startScreen').style.display = 'block';
            document.getElementById('progressBar').style.width = '0%';
        }
    </script>
</body>
</html>